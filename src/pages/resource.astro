---
import Layout from "../layouts/Layout.astro";
import { createTranslator } from "../i18n/utils";
import ResourceHero from "../components/resource/ResourceHero.astro";
import ResourceSearchAndFilter from "../components/resource/ResourceSearchAndFilter.astro";
import ResourceTabsWrapper from "../components/resource/ResourceTabsWrapper.astro";
import ResourceCardGrid from "../components/resource/ResourceCardGrid.astro";
import ResourceTable from "../components/resource/ResourceTable.astro";

const t = createTranslator("th");
const pageTitle = t("common.forms") + " - " + t("site.title");

// Mock data for demonstration
const recommendedDocs = [
  {
    title: "คู่มือการใช้งานระบบ E-mail สำหรับนักศึกษา",
    description: "คู่มือการใช้งานระบบอีเมลสำหรับนักศึกษาและบุคลากร",
    tag: "คู่มือการใช้งาน",
    fileType: "PDF",
    size: "2.5 MB",
    date: "15 มิถุนายน 2567",
    viewUrl: "#",
  },
  {
    title: "วิธีการตั้งค่า VPN",
    description: "คำแนะนำในการตั้งค่า VPN สำหรับการเข้าถึงระบบจากภายนอก",
    tag: "คู่มือติดตั้ง",
    fileType: "PDF",
    size: "3.2 MB",
    date: "5 มิถุนายน 2567",
    viewUrl: "#",
  },
];

const allDocs = [
  {
    title: "คู่มือการใช้งานระบบ E-mail สำหรับนักศึกษา",
    description: "คู่มือการใช้งานระบบอีเมลสำหรับนักศึกษาและบุคลากร",
    tag: "คู่มือการใช้งาน",
    fileType: "PDF",
    size: "2.5 MB",
    date: "15 มิถุนายน 2567",
    viewUrl: "#",
  },
  {
    title: "นโยบายความปลอดภัยทางไซเบอร์",
    description: "นโยบายและแนวทางปฏิบัติด้านความปลอดภัยทางไซเบอร์",
    tag: "นโยบาย",
    fileType: "PDF",
    size: "1.8 MB",
    date: "10 มิถุนายน 2567",
    viewUrl: "#",
  },
  {
    title: "แบบฟอร์มขออนุญาตใช้งานระบบ",
    description: "แบบฟอร์มสำหรับยื่นขออนุญาตเข้าใช้งานระบบสารสนเทศ",
    tag: "แบบฟอร์ม",
    fileType: "DOCX",
    size: "0.5 MB",
    date: "8 มิถุนายน 2567",
    viewUrl: "#",
  },
  {
    title: "วิธีการตั้งค่า VPN",
    description: "คำแนะนำในการตั้งค่า VPN สำหรับการเข้าถึงระบบจากภายนอก",
    tag: "คู่มือติดตั้ง",
    fileType: "PDF",
    size: "3.2 MB",
    date: "5 มิถุนายน 2567",
    viewUrl: "#",
  },
  {
    title: "รายงานประจำปี 2567",
    description: "รายงานสรุปการดำเนินงานด้านเทคโนโลยีสารสนเทศประจำปี 2567",
    tag: "รายงาน",
    fileType: "PDF",
    size: "5.0 MB",
    date: "1 มิถุนายน 2567",
    viewUrl: "#",
  },
];
---

<Layout title={pageTitle}>
  <main>
    <div class="container mx-auto px-4">
      <ResourceHero />
      <ResourceSearchAndFilter />
      <ResourceTabsWrapper />

      <!-- Card View -->
      <div id="card-view">
        <ResourceCardGrid title="เอกสารแนะนำ" documents={recommendedDocs} />
        <ResourceCardGrid title="เอกสารทั้งหมด" documents={allDocs} />
      </div>

      <!-- Table View (initially hidden) -->
      <div id="table-view" class="hidden">
        <ResourceTable title="เอกสารแนะนำ" documents={recommendedDocs} />
        <ResourceTable title="เอกสารทั้งหมด" documents={allDocs} />
      </div>
    </div>
  </main>
</Layout>

<script>
  document.addEventListener("astro:page-load", () => {
    const cardView = document.getElementById("card-view");
    const tableView = document.getElementById("table-view");

    document.addEventListener("view-change", (event) => {
      const customEvent = event as CustomEvent;
      const view = customEvent.detail.view;

      if (view === "card") {
        cardView?.classList.remove("hidden");
        tableView?.classList.add("hidden");
      } else if (view === "table") {
        cardView?.classList.add("hidden");
        tableView?.classList.remove("hidden");
      }
    });
  });
</script>
